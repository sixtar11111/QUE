<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—®å·äº’å¡«æ± </title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; padding: 40px 20px; background: #f4f6f8; color: #333; }
        .box { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); max-width: 600px; margin: 0 auto; }
        h1 { color: #0052d9; margin-bottom: 10px; }
        p { color: #666; margin-bottom: 30px; }
        
        .input-group { margin-bottom: 15px; text-align: left; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 16px; transition: 0.3s; }
        input:focus { border-color: #0052d9; outline: none; }

        button { width: 100%; padding: 14px; background: #0052d9; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; font-weight: bold; margin-top: 10px;}
        button:hover { background: #003bb3; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        #result { margin-top: 30px; text-align: left; display: none; background: #f0f8ff; padding: 20px; border-radius: 8px; border: 1px solid #d9eaff; }
        .link-item { margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #ccc; }
        .link-item:last-child { border-bottom: none; }
        .link-item a { color: #0052d9; text-decoration: none; word-break: break-all; }
        .link-item a:hover { text-decoration: underline; }
        .tip { font-size: 0.85em; color: #888; margin-top: 5px; }
    </style>
</head>
<body>

    <div class="box">
        <h1>ğŸš€ é—®å·äº’å¡«æ± </h1>
        <p>ä½ å¸®åˆ«äººå¡«çš„è¶Šå¤šï¼Œä½ çš„é—®å·å±•ç¤ºç»™åˆ«äººçš„æœºä¼šå°±è¶Šå¤šï¼</p>
        
        <div class="input-group">
            <label>ä½ çš„é—®å·é“¾æ¥ï¼š</label>
            <input type="url" id="myUrl" placeholder="https://...">
        </div>

        <div class="input-group">
            <label>è¿™æ¬¡ä½ æƒ³å¸®å¡«å‡ ä»½ï¼Ÿ(1-10)</label>
            <input type="number" id="wantCount" value="3" min="1" max="10">
            <div class="tip">å»ºè®®å¡« 3-5 ä»½ï¼Œè¿™æ ·ä½ çš„é“¾æ¥ä¹Ÿä¼šè¢«ä¼˜å…ˆå±•ç¤ºç»™ 3-5 ä¸ªäººã€‚</div>
        </div>

        <button onclick="startExchange()" id="btn">æäº¤å¹¶è·å–äº’å¡«é“¾æ¥</button>

        <div id="result"></div>
    </div>

    <script>
        async function startExchange() {
            const urlInput = document.getElementById('myUrl').value;
            const countInput = document.getElementById('wantCount').value;
            const resultDiv = document.getElementById('result');
            const btn = document.getElementById('btn');

            if (!urlInput) return alert("è¯·å¡«å†™ä½ çš„é“¾æ¥");
            
            btn.disabled = true;
            btn.innerText = "æ­£åœ¨åŒ¹é…ä¸­...";
            resultDiv.style.display = 'none';

            try {
                // è¯·æ±‚æˆ‘ä»¬æ–°çš„åç«¯å‡½æ•°
                const res = await fetch('/exchange', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ 
                        url: urlInput,
                        count: countInput
                    })
                });

                const data = await res.json();

                if (data.error) throw new Error(data.error);

                // æ˜¾ç¤ºç»“æœ
                let html = `<h3>âœ… æäº¤æˆåŠŸï¼è¯·å¡«å†™ä»¥ä¸‹ ${data.links.length} ä¸ªé—®å·ï¼š</h3>`;
                
                if (data.links.length === 0) {
                    html += `<p style="color:red">ç›®å‰åº“é‡Œæ²¡æœ‰å…¶ä»–é“¾æ¥ï¼Œä½ æ˜¯ç¬¬ä¸€ä¸ªï¼ç¨ååˆ«äººä¸Šä¼ æ—¶ä¼šä¼˜å…ˆçœ‹åˆ°ä½ çš„é“¾æ¥ã€‚</p>`;
                } else {
                    data.links.forEach((link, index) => {
                        html += `
                        <div class="link-item">
                            <span>${index + 1}. </span>
                            <a href="${link.url}" target="_blank">${link.url}</a>
                        </div>`;
                    });
                }
                
                resultDiv.innerHTML = html;
                resultDiv.style.display = 'block';

            } catch (error) {
                alert("å‡ºé”™äº†ï¼š" + error.message);
            } finally {
                btn.disabled = false;
                btn.innerText = "æäº¤å¹¶è·å–äº’å¡«é“¾æ¥";
            }
        }
    </script>
</body>
</html>
